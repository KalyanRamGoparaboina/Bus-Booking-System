{% extends "base.html" %}

{% block title %}Admin Dashboard - VALMIKI TRAVELS{% endblock %}

{% block content %}
<div class="container animate-fade" style="margin-top: 50px;">
    <h1 style="margin-bottom: 40px; color: var(--primary-color);">Global Fleet Management</h1>

    <!-- Stats Bar -->
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 40px;">
        <div class="glass" style="padding: 30px; border-left: 5px solid var(--primary-color);">
            <p style="color: var(--text-light); font-size: 0.8rem; font-weight: 800; text-transform: uppercase;">Fleet
                Size</p>
            <h2 style="font-size: 2.2rem; margin-top: 5px;">{{ buses|length }} <span
                    style="font-size: 1rem; color: #666;">Buses</span></h2>
        </div>
        <div class="glass" style="padding: 30px; border-left: 5px solid #2e7d32; background: rgba(46, 125, 50, 0.02);">
            <p style="color: var(--text-light); font-size: 0.8rem; font-weight: 800; text-transform: uppercase;">Total
                Revenue</p>
            <h2 style="font-size: 2.2rem; margin-top: 5px; color: #2e7d32;">₹{{ total_revenue }}</h2>
        </div>
        <div class="glass" style="padding: 30px; border-left: 5px solid #1a237e; background: rgba(26, 35, 126, 0.02);">
            <p style="color: var(--text-light); font-size: 0.8rem; font-weight: 800; text-transform: uppercase;">Global
                Bookings</p>
            <h2 style="font-size: 2.2rem; margin-top: 5px; color: #1a237e;">{{ total_seats }} <span
                    style="font-size: 1rem; color: #666;">Seats</span></h2>
        </div>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
        <h2>Active Buses</h2>
        <a href="/admin/add_bus" class="btn btn-primary">+ Add New Bus Schedule</a>
    </div>

    <div class="glass" style="overflow-x: auto; padding: 0;">
        <table style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead>
                <tr style="background: rgba(26,35,126,0.05); color: var(--primary-color);">
                    <th style="padding: 20px;">Bus ID</th>
                    <th style="padding: 20px;">Bus Name</th>
                    <th style="padding: 20px;">Route</th>
                    <th style="padding: 20px;">Capacity</th>
                    <th style="padding: 20px;">Seats Booked</th>
                    <th style="padding: 20px;">Next Schedule</th>
                    <th style="padding: 20px; text-align: right;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for bus in buses %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 20px; font-weight: 700;">#{{ bus.id }}</td>
                    <td style="padding: 20px;">
                        <span style="font-weight: 600;">{{ bus.name }}</span>
                        <p style="font-size: 0.8rem; color: var(--text-light);">₹{{ bus.price }}/seat</p>
                    </td>
                    <td style="padding: 20px;">{{ bus.source }} → {{ bus.destination }}</td>
                    <td style="padding: 20px;">
                        <span style="background: #f3f4f6; padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">{{
                            bus.available_seats }} seats</span>
                    </td>
                    <td style="padding: 20px;">
                        <strong style="color: #1a237e;">{{ bus.total_bookings }}</strong>
                    </td>
                    <td style="padding: 20px; font-size: 0.85rem;">{{ bus.departure }}</td>
                    <td style="padding: 20px; text-align: right; display: flex; gap: 10px; justify-content: flex-end;">
                        <a href="/admin/bus_details/{{ bus.id }}" class="btn"
                            style="background: #e3f2fd; color: #1976d2; padding: 8px 15px; font-size: 0.8rem;">View
                            Bookings</a>
                        <form action="/admin/delete_bus/{{ bus.id }}" method="POST"
                            onsubmit="return confirm('Delete this bus and all its schedules?');">
                            <button type="submit" class="btn"
                                style="background: #ffebee; color: #d32f2f; padding: 8px 15px; font-size: 0.8rem;">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}